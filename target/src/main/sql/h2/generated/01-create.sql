--
-- (c) Copyright 2005-2015 JAXIO, http://www.jaxio.com
-- Source code generated by Celerio, a Jaxio product
-- Want to purchase Celerio ? email us at info@jaxio.com
-- Follow us on twitter: @springfuse
-- Documentation: http://www.jaxio.com/documentation/celerio/
-- Template pack-backend-jpa:src/main/sql/h2/01-create.p.vm.sql
--

DROP ALL objects;


-- =================================
-- TABLE ACCOUNT 
-- =================================

CREATE TABLE ACCOUNT (
	ID CHAR(36) not null,
	LOGIN VARCHAR(100) not null,
	PASSWORD VARCHAR(100) not null,
	EMAIL VARCHAR(100) not null,
	IS_ENABLED DECIMAL(1) not null,
	CIVILITY CHAR(2),
	FIRST_NAME VARCHAR(100),
	LAST_NAME VARCHAR(100),
	BIRTH_DATE TIMESTAMP,
	DESCRIPTION VARCHAR(255),
	ADDRESS_ID DECIMAL(10),
	CREATION_DATE TIMESTAMP,
	CREATION_AUTHOR VARCHAR(200),
	LAST_MODIFICATION_DATE TIMESTAMP,
	LAST_MODIFICATION_AUTHOR VARCHAR(200),
	VERSION DECIMAL(10) default 0);

CREATE UNIQUE INDEX IF NOT EXISTS ACCOUNT_UNIQUE_2 ON ACCOUNT (EMAIL);
CREATE UNIQUE INDEX IF NOT EXISTS ACCOUNT_UNIQUE_1 ON ACCOUNT (LOGIN);
CREATE UNIQUE INDEX IF NOT EXISTS SYS_C004031 ON ACCOUNT (ID);
CREATE PRIMARY KEY ON ACCOUNT (ID);

-- =================================
-- TABLE ACCOUNT_ROLE 
-- =================================

CREATE TABLE ACCOUNT_ROLE (
	ACCOUNT_ID CHAR(36) not null,
	ROLE_ID DECIMAL(10) not null);

CREATE UNIQUE INDEX IF NOT EXISTS SYS_C004041 ON ACCOUNT_ROLE (ACCOUNT_ID, ROLE_ID);
CREATE PRIMARY KEY ON ACCOUNT_ROLE (ACCOUNT_ID, ROLE_ID);

-- =================================
-- TABLE ADDRESS 
-- =================================

CREATE TABLE ADDRESS (
	ID DECIMAL(10) not null,
	STREET_NAME VARCHAR(100),
	CITY VARCHAR(100) not null,
	VERSION DECIMAL(10) default 0);

CREATE UNIQUE INDEX IF NOT EXISTS SYS_C004025 ON ADDRESS (ID);
ALTER TABLE ADDRESS ALTER COLUMN ID IDENTITY;


-- =================================
-- TABLE BOOK 
-- =================================

CREATE TABLE BOOK (
	ID DECIMAL(10) not null,
	ACCOUNT_ID CHAR(36),
	TITLE VARCHAR(100) not null,
	NUMBER_OF_PAGES DECIMAL(10) not null,
	VERSION DECIMAL(10) default 0);

CREATE UNIQUE INDEX IF NOT EXISTS SYS_C004054 ON BOOK (ID);
ALTER TABLE BOOK ALTER COLUMN ID IDENTITY;


-- =================================
-- TABLE DBUSER 
-- =================================

CREATE TABLE DBUSER (
	USER_ID DECIMAL(5) not null,
	USERNAME VARCHAR(20) not null,
	CREATED_BY VARCHAR(20) not null,
	CREATED_DATE DATE not null);

CREATE UNIQUE INDEX IF NOT EXISTS SYS_C004067 ON DBUSER (USER_ID);
ALTER TABLE DBUSER ALTER COLUMN USER_ID IDENTITY;


-- =================================
-- TABLE DOCUMENT 
-- =================================

CREATE TABLE DOCUMENT (
	ID CHAR(36) not null,
	ACCOUNT_ID CHAR(36) not null,
	DOCUMENT_BINARY BLOB(4000),
	DOCUMENT_FILE_NAME VARCHAR(100) not null,
	DOCUMENT_CONTENT_TYPE VARCHAR(100) not null,
	DOCUMENT_SIZE DECIMAL(10) not null,
	VERSION DECIMAL(10) default 0);

CREATE UNIQUE INDEX IF NOT EXISTS SYS_C004049 ON DOCUMENT (ID);
CREATE PRIMARY KEY ON DOCUMENT (ID);

-- =================================
-- TABLE LEGACY 
-- =================================

CREATE TABLE LEGACY (
	NAME VARCHAR(16) not null,
	CODE VARCHAR(8) not null,
	DEPT DECIMAL(10) not null,
	EXTRA_INFO VARCHAR(100) not null);

CREATE UNIQUE INDEX IF NOT EXISTS SYS_C004062 ON LEGACY (NAME, CODE, DEPT);
CREATE PRIMARY KEY ON LEGACY (CODE, DEPT, NAME);

-- =================================
-- TABLE MORE_TYPES_DEMO 
-- =================================

CREATE TABLE MORE_TYPES_DEMO (
	ID DECIMAL(10) not null,
	NUMBER_INT DECIMAL(10),
	NUMBER_LONG DECIMAL(11),
	NUMBER_DOUBLE FLOAT(126),
	NUMBER_FLOAT FLOAT(63),
	NUMBER_BIG_INTEGER DECIMAL(20),
	NUMBER_BIG_DECIMAL DECIMAL(20,2),
	DATE_JAVA_TEMPORAL_DATE DATE,
	DATE_JAVA_TEMPORAL_TIMESTAMP TIMESTAMP,
	DATE_JODA DATE,
	DATE_TIME_JODA TIMESTAMP,
	VERSION DECIMAL(10) default 0);

CREATE UNIQUE INDEX IF NOT EXISTS SYS_C004057 ON MORE_TYPES_DEMO (ID);
ALTER TABLE MORE_TYPES_DEMO ALTER COLUMN ID IDENTITY;


-- =================================
-- TABLE ROLE 
-- =================================

CREATE TABLE ROLE (
	ID DECIMAL(10) not null,
	ROLE_NAME VARCHAR(100) not null);

CREATE UNIQUE INDEX IF NOT EXISTS SYS_C004037 ON ROLE (ID);
CREATE UNIQUE INDEX IF NOT EXISTS ROLE_UNIQUE_1 ON ROLE (ROLE_NAME);
ALTER TABLE ROLE ALTER COLUMN ID IDENTITY;

ALTER TABLE ACCOUNT ADD CONSTRAINT ACCOUNT_FK_1 FOREIGN KEY (ADDRESS_ID) REFERENCES ADDRESS (ID);
ALTER TABLE ACCOUNT_ROLE ADD CONSTRAINT ACCOUNT_ROLE_FK_2 FOREIGN KEY (ROLE_ID) REFERENCES ROLE (ID);
ALTER TABLE ACCOUNT_ROLE ADD CONSTRAINT ACCOUNT_ROLE_FK_1 FOREIGN KEY (ACCOUNT_ID) REFERENCES ACCOUNT (ID);
ALTER TABLE BOOK ADD CONSTRAINT BOOK_FK_1 FOREIGN KEY (ACCOUNT_ID) REFERENCES ACCOUNT (ID);
ALTER TABLE DOCUMENT ADD CONSTRAINT DOCUMENT_FK_1 FOREIGN KEY (ACCOUNT_ID) REFERENCES ACCOUNT (ID);